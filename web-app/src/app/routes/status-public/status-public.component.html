<nz-spin [nzSpinning]="loading" [nzTip]="'Loading...'" nzSize="large">
  <div class="status-header" style="background: #5865f2">
    <div>
      <a [href]="statusOrg.home" target="_blank">
        <img class="status-logo" [src]="statusOrg.logo" alt="" />
      </a>
    </div>
  </div>
</nz-spin>

<nz-spin [nzSpinning]="loading" [nzTip]="'Loading...'" nzSize="large">
  <div class="status-content">
    <div style="margin-top: 20px; margin-bottom: 20px">
      <div style="width: 60%; margin: 0 auto; text-align: right">
        <button nz-button> FEEDBACK ISSUES </button>
      </div>
    </div>
    <div *ngIf="statusOrg.state == 0" class="org-status" style="background-color: green; display: flex; justify-content: space-between">
      <div>
        <span nz-icon style="color: #f0f0f0" nzType="check-circle" nzTheme="outline"></span>
        <span style="color: #f0f0f0; margin-left: 4px"> All Systems Operational </span>
      </div>
      <div>
        <span style="color: #f0f0f0; margin-right: 4px; font-size: medium"> Updated {{ statusOrg.gmtUpdate | elapsedTime }} </span>
      </div>
    </div>
    <div *ngIf="statusOrg.state == 1" class="org-status" style="background-color: orange; display: flex; justify-content: space-between">
      <div>
        <span nz-icon style="color: #f0f0f0" nzType="exclamation-circle" nzTheme="outline"></span>
        <span style="color: #f0f0f0; margin-left: 4px"> Some Systems Abnormal </span>
      </div>
      <div>
        <span style="color: #f0f0f0; margin-right: 4px; font-size: medium"> Updated {{ statusOrg.gmtUpdate | elapsedTime }} </span>
      </div>
    </div>
    <div *ngIf="statusOrg.state == 2" class="org-status" style="background-color: red; display: flex; justify-content: space-between">
      <div>
        <span nz-icon style="color: #f0f0f0" nzType="close-circle" nzTheme="outline"></span>
        <span style="color: #f0f0f0; margin-left: 4px"> All Systems Abnormal </span>
      </div>
      <div>
        <span style="color: #f0f0f0; margin-right: 4px; font-size: medium"> Updated {{ statusOrg.gmtUpdate | elapsedTime }} </span>
      </div>
    </div>
    <div style="margin-top: 50px">
      <div *ngFor="let component of componentStatus" class="component-status">
        <div style="margin: 10px; display: flex; justify-content: space-between">
          <div style="font-weight: bold; font-size: large">
            <span>{{ component.info.name }}</span>
            <span
              style="margin-left: 4px"
              nz-icon
              nzType="question-circle"
              nzTheme="outline"
              nz-tooltip
              [nzTooltipTitle]="component.info.desc"
            ></span>
          </div>
          <div *ngIf="component.info.currentState == 0" style="font-weight: bold">
            <span style="color: green">Normal</span>
            <span nz-icon style="color: green; margin-left: 4px" nzType="check-circle" nzTheme="outline"></span>
          </div>
          <div *ngIf="component.info.currentState == 1" style="font-weight: bold">
            <span style="color: red">Abnormal</span>
            <span nz-icon style="color: red; margin-left: 4px" nzType="exclamation-circle" nzTheme="outline"></span>
          </div>
          <div *ngIf="component.info.currentState == 2" style="font-weight: bold">
            <span>Unknown</span>
            <span nz-icon style="margin-left: 4px" nzType="stop" nzTheme="outline"></span>
          </div>
        </div>
        <div style="margin-left: 10px; margin-top: 10px; margin-bottom: 10px; display: flex">
          <div
            *ngFor="let historyItem of component.history"
            class="history_block"
            [style]="'background:' + calculateHistoryBlockRgb(historyItem)"
            nz-popover
            [nzPopoverContent]="contentTemplate"
            nzPopoverPlacement="bottom"
          >
            <ng-template #contentTemplate>
              <div>
                <p style="font-weight: bold">{{ historyItem.timestamp | date }}</p>
                <p>Uptime {{ (100 * historyItem.uptime).toFixed(2) }}%</p>
                <p>Normal {{ historyItem.normal }}s</p>
                <p>Abnormal {{ historyItem.abnormal }}s</p>
                <p>Unknown {{ historyItem.unknown }}s</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</nz-spin>

<nz-divider style="margin-top: 60px"></nz-divider>
